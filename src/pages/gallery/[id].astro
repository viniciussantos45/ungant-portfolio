---
import ImagesGallery from "../../components/ui/images-gallery";
import VideosGallery from "../../components/ui/videos-gallery";
import { projectItems } from "../../data/projects";
import PrincipalLayout from "../../layouts/PrincipalLayout.astro";

export async function getStaticPaths() {
  return projectItems.map((project) => ({
    params: { id: project.id },
    props: { project },
  }));
}

const { project } = Astro.props;

// Prepare photos for the images gallery
const imageItems = project.photos.map((photo) => ({
  title: `${project.title} - Photo`,
  description: project.description,
  src: photo.src,
  thumb: photo.src,
  alt: `${project.title} photo`,
}));

// Prepare videos for the videos gallery
const videoItems = project.videos.map((video, index) => ({
  title: `${project.title} - Video ${index + 1}`,
  description: project.description,
  src: video.src,
  thumb: project.image, // Use project cover as thumbnail for videos
  alt: `${project.title} video`,
}));
---

<PrincipalLayout>
  <div class="px-4 lg:px-8 py-8 md:py-12">
    <div class="max-w-7xl mx-auto">
      <div class="mb-12 md:mb-16">
        <a href="/projetos" class="inline-flex items-center gap-2 text-secondary hover:text-primary transition-colors mb-6 group">
          <svg class="w-5 h-5 transform group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
          <span class="font-semibold">Voltar aos Projetos</span>
        </a>
        <h1 class="text-4xl md:text-6xl lg:text-7xl font-black text-primary mb-6">{project.title}</h1>
        <p class="text-xl md:text-2xl text-secondary leading-relaxed mb-3">{project.description}</p>
        <p class="text-base md:text-lg text-secondary/70">{project.subtitle}</p>
      </div>

      {/* Videos Section */}
      {
        videoItems.length > 0 && (
          <section class="mb-16 md:mb-20">
            <h2 class="text-2xl md:text-3xl font-bold text-foreground mb-8">Vídeos</h2>
            <VideosGallery client:load videos={videoItems} />
          </section>
        )
      }

      {/* Images Section */}
      {
        imageItems.length > 0 && (
          <section class="mb-16 md:mb-20">
            <h2 class="text-2xl md:text-3xl font-bold text-foreground mb-8">Fotos</h2>
            <ImagesGallery client:load images={imageItems} />
          </section>
        )
      }

      {
        imageItems.length === 0 && videoItems.length === 0 && (
          <div class="text-center py-20">
            <p class="text-lg text-secondary/60">Nenhuma mídia disponível para este projeto.</p>
          </div>
        )
      }
    </div>
  </div>
</PrincipalLayout>
