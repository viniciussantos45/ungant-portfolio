---
import ImagesGallery from "../../components/ui/images-gallery";
import VideosGallery from "../../components/ui/videos-gallery";
import PrincipalLayout from "../../layouts/PrincipalLayout.astro";
import { projectItems } from "../../data/projects";

export async function getStaticPaths() {
  return projectItems.map((project) => ({
    params: { id: project.id },
    props: { project },
  }));
}

const { project } = Astro.props;

// Prepare photos for the images gallery
const imageItems = project.photos.map((photo) => ({
  title: `${project.title} - Photo`,
  description: project.description,
  src: photo.src,
  thumb: photo.src,
  alt: `${project.title} photo`,
}));

// Prepare videos for the videos gallery
const videoItems = project.videos.map((video, index) => ({
  title: `${project.title} - Video ${index + 1}`,
  description: project.description,
  src: video.src,
  thumb: project.image, // Use project cover as thumbnail for videos
  alt: `${project.title} video`,
}));
---

<PrincipalLayout>
  <div class="container mx-auto px-4 py-8">
    <div class="mb-8">
      <h1 class="text-4xl font-bold mb-4">{project.title}</h1>
      <p class="text-lg text-gray-600 mb-2">{project.description}</p>
      <p class="text-sm text-gray-500">{project.subtitle}</p>
    </div>
    
    {/* Images Section */}
    {imageItems.length > 0 && (
      <section class="mb-12">
        <h2 class="text-2xl font-semibold mb-6">Photos</h2>
        <ImagesGallery client:load images={imageItems} />
      </section>
    )}
    
    {/* Videos Section */}
    {videoItems.length > 0 && (
      <section class="mb-12">
        <h2 class="text-2xl font-semibold mb-6">Videos</h2>
        <VideosGallery client:load videos={videoItems} />
      </section>
    )}
    
    {imageItems.length === 0 && videoItems.length === 0 && (
      <div class="text-center py-12">
        <p class="text-gray-500">No media available for this project.</p>
      </div>
    )}
  </div>
</PrincipalLayout>